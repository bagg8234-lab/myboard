{% extends "base.html" %}

{% block content %}
<div class="container py-4">

  <!-- Header -->
  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h1 class="fw-bold m-0" style="font-size: 2.2rem;">ğŸ£ ë³‘ì•„ë¦¬ ì •ë³´ ğŸ£</h1>
      <p class="text-muted small mb-0" style="font-size: 1.1rem;">ìŠ¤í‚¤ë§ˆ : fms | í…Œì´ë¸” : chick_info</p>
    </div>

    <div class="d-flex align-items-center gap-2">
      <span class="badge bg-secondary" style="font-size: 1.1rem;">ì´ {{ results|length if results else 0 }}ê±´</span>
      
    </div>
  </div>

  <div class="card shadow-sm border-0">
    <div class="card-body p-0">

      {% if results and results|length > 0 %}
      <div class="table-responsive" style="max-height: 75vh;">
        <table id="resultTable" class="table table-bordered table-hover align-middle mb-0 table-white">
          <thead class="sticky-top table-head-white">
            <tr>
              {% for key in results[0].keys() %}
              <th class="text-nowrap position-relative bg-white" data-col-index="{{ loop.index0 }}">
                <div class="d-flex flex-column align-items-start gap-1">
                  <span class="fw-semibold" style="font-size: 1.1rem;">{{ key }}</span>
                  <div class="dropdown">
                    <button class="btn btn-sm btn-light border py-0 px-2"
                            type="button"
                            data-bs-toggle="dropdown"
                            data-bs-auto-close="outside"
                            data-bs-offset="0,5"
                            aria-expanded="false"
                            title="í•„í„°">
                      â–¼
                    </button>

                    <div class="dropdown-menu p-2 shadow-sm" style="min-width: 240px; max-height: 300px; overflow:auto;">
                      <div class="filter-box" data-col-index="{{ loop.index0 }}">
                        <!-- JSê°€ ê°’ ëª©ë¡ ì±„ì›€ -->
                      </div>
                    </div>
                  </div>
                </div>
              </th>
              {% endfor %}
            </tr>
          </thead>

          <tbody id="tableBody">
            {% for result in results %}
            <tr>
              {% for value in result.values() %}
              <td data-col-index="{{ loop.index0 }}" class="bg-white text-center" style="font-size: 1.1rem;">
                {% if value is none %}
                  <span class="text-muted">-</span>
                {% else %}
                  <span title="{{ value }}">
                    {{ value }}
                  </span>
                {% endif %}
              </td>
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="p-4">
        <div class="alert alert-warning mb-0">
          ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
        </div>
      </div>
      {% endif %}

    </div>
  </div>

</div>

{% if results and results|length > 0 %}
<style>
  :root {
    --bg: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --line: #e5e7eb;
    --line-strong: #d1d5db;
    --header-bg: #f8fafc;
    --header-text: #374151;
    --chip-bg: #e5e7eb;
    --chip-text: #374151;
  }

  /* âœ… â€œí‘œì²˜ëŸ¼ í•˜ì–—ê²Œâ€ ë³´ì´ë„ë¡ */
  .table-white {
    background: var(--bg);
  }

  .table-head-white th {
    background: var(--header-bg) !important;
    color: var(--header-text) !important;
    border-bottom: 1px solid var(--line-strong) !important;
  }

  .table-white tbody tr:hover td {
    background: #f9fafb !important;
  }

  th, td {
    vertical-align: middle;
    color: var(--text);
  }

  #resultTable {
    table-layout: auto;
    width: max-content;
    border: 1px solid var(--line-strong);
  }

  #resultTable th,
  #resultTable td {
    border: 1px solid var(--line);
  }

  .badge.bg-secondary {
    background: var(--chip-bg) !important;
    color: var(--chip-text) !important;
  }
</style>

<!-- í—¤ë” ìŠ¤íƒ€ì¼ ì¶”ê°€ -->
<style>
  .table-head-white th span {
    color: var(--header-text) !important;
  }

  .table-head-white th .btn-light {
    background-color: #f9fafb !important;
    border-color: var(--line) !important;
    color: var(--muted) !important;
  }

  .table-head-white th .btn-light:hover {
    background-color: var(--header-bg) !important;
  }
</style>

{% endif %}
{% endblock %}
